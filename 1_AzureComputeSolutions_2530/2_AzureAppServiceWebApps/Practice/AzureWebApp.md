- You will always need an APP service Plan to define the compute and memory requirements

- Sku and size : You can have different offers

- An APP service Plan will always be created with your Azure Web APPs

- Azure Web apps will
    - Create virtual machines for you
    - Maintain those machines
    - Install the required runtime - ASP.NET core applications
    - IIS and the runtime is installed

- App Service Plans
   - If you create an Azure Web app two resources will be created 
    : Azure web app and an azure service Plan

- Publish a .NET 6 application to azure web app

- You can use the same service Plan to for another WeApp creation
   - However you need to use the same env. : Linux or Windows for example

## Publishing from Visual studio

- You can directly create a Publish profile from visual studio and publish your APP


## Connecting our app to SQL server database 

- With SQl database many aspects are managed for you
- Create a new Sql db/server 
    appuser
    ZakariaAz@20152015
- You will APP service you will show and you can directly use it to publish your app
- After publishing the APP from visual studio you will have your app published

## Publishing from GitHub

- You can publish directlty from Github
- At App service level you can go to deployment center and select a 'Source' as GitHub 
- You just need to select a repository and a branch that will be used to get your code
  and deploy automatically .

## Using the Azure Web App connection string

- We can define our connection string at azure web app level
- Azure Web App > Configuration > Connection string
- The .NET app is able to pick the connection string using the IConfiguration service

## Azure App service logging

- To check in details on the learn section
- Application Logging : Log messages that are generated by application code
- Web server Logging : Raw http request data
- Detailed error messages : Stores copies of .htm error pages that would have been sent to client browser
- Deployment logging
- You can also stream logs on real time

## Azure Web Apps - Autoscaling

- Basic service plan : up to 3 machines , but it's manual 
- To do an automatic scaling 
- Auto scaling is available in the Standard service Plan or higher
- The scaling is done at Service Plan level
- Cool down period : Autoscaling service is not going to trigger anything . This time is necessary
  to give enough time for the new infrastructure to be used .
- You should find more details on the official documentation part .
- TODO to check more at documentation level

## Custom domains

- Also to check on official docs

## Azure Web Apps - SSL

- Go to TLS/SSL settings
- Create App Service Managed Certificates
- Normally if you create a custom domain and try to access your app it will show as insecure
- This should be linked to a Custom domain

## Deployment Slots

- Standard or higher to be able to use deployment Slot
- Slots are interesting in a way of quickly switching the deployed app with another in
  staging . This is interesting because you can also do the inverse and get the staging
  back and deploy the production .

## Deployment slots with databases

- You can use slots with databases 
- For for a given connection string you just check the option : 'Deployment Slot settings'
- If done the next time a swap is done you will have the connection string swapped also 

# Azure App Configuration - Configuration Settings

- Use also use this Azure service to manage configuration settings .
- You can handle this using the right packge at .NET level
  - var connectionString = "Endpoint=https://appconfig1000233....";
  - builder.AddAzureAppConfiguration(connectionString);
  - You can simply use : _configuration["SQLConnection"]
  - If no AppConfiguration is use dthe _configuration will pick the defined at APP service level
  - Intersting to know how this IConfiguration service actually works

# Azure App Configuration - Feature Flags

- Let us get : Microsoft.Azure.AppConfiguration.AspNetCore
- And : Microsoft.FeatureManagement.AspNetCore
- By using this feature it will be managed automatically with no need to change at APP level
   - builder.AddAzureAppConfiguration(
               options => options.Connect(connectionString).UseFeatureFlags());
   - builder.Services.AddFeatureManagement();
   - using Microsoft.FeatureManagement;
   - if (await _featureManager.IsEnabledAsync("beta")) => ...
   - Feature Flags is within App configuration => FeatureManager
- Feature Flags with controllers : 
  https://docs.microsoft.com/en-us/azure/azure-app-configuration/use-feature-flags-dotnet-core?tabs=core5x